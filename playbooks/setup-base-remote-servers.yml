---

- hosts: loadbalancer, webserver, database
  become: yes
  
  tasks:
    - name: update yum
      command: yum update -y

    # Install EPEL
    - name: install epel
      yum:
        name: epel-release
        state: present

    - name: enable epel repo
      shell: yum-config-manager --enable epel


    # Install Python
    - name: install python 3.4
      yum:
        name: [ "python34", "python34-setuptools" ]
        state: present
        update_cache: yes

    # Install Pip
    - name: install pip
      easy_install:
        executable: easy_install-3.4
        name: pip
        state: present


    - name: install banner
      yum:
        name: figlet
        state: present
        update_cache: yes


- hosts: loadbalancer
  tasks:
    - name: put server name into file
      shell: echo 'Load Balancer' > ~/LoadBalancer.txt

- hosts: webserver
  tasks:
    - name: put server name into file
      shell: echo 'Web Server' > ~/WebServer.txt

- hosts: database
  tasks:
    - name: put server name into file
      shell: echo 'Database' > ~/Database.txt